+++
title = "Floating fees in Bitcoin Core 0.10"
description = 'Originally published on jonathanpatrick.me.'
date = 2015-02-16
draft = false
template = "blog/page.html"

[taxonomies]
authors = ["Jonathan Brown"]

[extra]
+++

Retrieved from the [Wayback Machine](https://web.archive.org/web/20180518225509/http://jonathanpatrick.me/blog/floating-fees).

<p>The <a target="_blank" href="https://web.archive.org/web/20180518225509/https://github.com/bitcoin/bitcoin/blob/0.10/doc/release-notes.md">latest release</a> of the Bitcoin reference implementation has 2 new RPC commands related to fees: <a target="_blank" href="https://web.archive.org/web/20180518225509/https://bitcoin.org/en/developer-reference#estimatepriority">estimatepriority</a> and <a target="_blank" href="https://web.archive.org/web/20180518225509/https://bitcoin.org/en/developer-reference#estimatefee">estimatefee</a>. They work by statistically observing the blockchain.</p>
<h2>estimatepriority &lt;nblocks&gt;</h2>
<blockquote><p>Estimates the approximate priority a zero-fee transaction needs to begin confirmation within nblocks blocks.</p></blockquote>
<p>The priority of a transaction can be calculated using the following formula:</p>
<p>priority = sum(input_value_in_base_units * input_age) / size_in_bytes</p>
<p>That is, the sum of the number of satoshis in each input multiplied by their age in blocks, divided my the total size of the transaction. The maximum size for a regular transaction can be determined from the number of inputs and outputs:</p>
<p>size_in_bytes = 149 * inputs + 34 * outputs + 10</p>
<p>The simplest transaction is defined as having 1 input and 2 outputs (227 bytes). In theory you could have just 1 output, but then you have no means to control how much of the input you are spending because there is no change address.</p>
<p>Previously the reference implementation would allow transactions into a block for free if they have a priority greater than 57,600,000. It also had to be smaller than 1,000 bytes and have all outputs <span class="bitcoin-font"></span><span style="white-space:nowrap;"> </span>0.01 or larger. Other implementations and miners have different settings, so it is hard to know what priority is really required.</p>
<p>Now with the estimatepriority command it is possible to determine what priority is required on average to get a transaction into a block for free within nblocks. At the time of writing it is reporting 15,075,940,700 for nblocks = 1. This is 262 times greater than the previous reference implementation and perhaps a more realistic representation of the current behaviour of miners. This means to send <span class="bitcoin-font"></span><span style="white-space:nowrap;"> </span>1 for free in the simplest transaction it would need to be 238 days old.</p>
<p>For it to confirm within 25 blocks it would need to be 12 days old. It's probably not worth endeavouring to not pay a fee on a transaction as for just $<span style="white-space:nowrap;"> </span>0.04 you are almost guaranteed to get the simplest transaction into the next block.</p>
<p>In fact, by default in 0.10 the reference Bitcoin wallet does not attempt to send zero-fee transactions.</p>
<h2>estimatefee &lt;nblocks&gt;</h2>
<blockquote><p>Estimates the approximate fee per kilobyte needed for a transaction to begin confirmation within nblocks blocks.</p></blockquote>
<p>I have added a transaction fees report page to my <a target="_blank" href="https://web.archive.org/web/20180518225509/https://www.drupal.org/project/cointools">Coin Tools</a> Drupal module. For all values of nblocks supported, it displays the average time for a transaction to confirm, the fee per kB, and the fee for the simplest transaction.</p>
<p>Below is a verbatim paste of the HTML table generated by Coin Tools at the time of writing:</p>
<table data-striping="1"><thead><tr><th>Blocks</th>
<th style="text-align: right;">Average time</th>
<th style="text-align: right;">Fee per kB (bits)</th>
<th style="text-align: right;">Smallest fee (bits)</th>
</tr></thead><tbody><tr class="odd"><td>1</td>
<td style="text-align: right;">8 min 23 sec</td>
<td style="text-align: right;">748.50 ≈ $<span style="white-space:nowrap;"> </span>0.1784</td>
<td style="text-align: right;">169.91 ≈ $<span style="white-space:nowrap;"> </span>0.0405</td>
</tr><tr class="even"><td>2</td>
<td style="text-align: right;">16 min 46 sec</td>
<td style="text-align: right;">456.62 ≈ $<span style="white-space:nowrap;"> </span>0.1088</td>
<td style="text-align: right;">103.65 ≈ $<span style="white-space:nowrap;"> </span>0.0247</td>
</tr><tr class="odd"><td>3</td>
<td style="text-align: right;">25 min 10 sec</td>
<td style="text-align: right;">444.44 ≈ $<span style="white-space:nowrap;"> </span>0.1059</td>
<td style="text-align: right;">100.89 ≈ $<span style="white-space:nowrap;"> </span>0.0240</td>
</tr><tr class="even"><td>4</td>
<td style="text-align: right;">33 min 33 sec</td>
<td style="text-align: right;">444.44 ≈ $<span style="white-space:nowrap;"> </span>0.1059</td>
<td style="text-align: right;">100.89 ≈ $<span style="white-space:nowrap;"> </span>0.0240</td>
</tr><tr class="odd"><td>5</td>
<td style="text-align: right;">41 min 57 sec</td>
<td style="text-align: right;">442.47 ≈ $<span style="white-space:nowrap;"> </span>0.1054</td>
<td style="text-align: right;">100.44 ≈ $<span style="white-space:nowrap;"> </span>0.0239</td>
</tr><tr class="even"><td>6</td>
<td style="text-align: right;">50 min 20 sec</td>
<td style="text-align: right;">442.47 ≈ $<span style="white-space:nowrap;"> </span>0.1054</td>
<td style="text-align: right;">100.44 ≈ $<span style="white-space:nowrap;"> </span>0.0239</td>
</tr><tr class="odd"><td>7</td>
<td style="text-align: right;">58 min 43 sec</td>
<td style="text-align: right;">389.10 ≈ $<span style="white-space:nowrap;"> </span>0.0927</td>
<td style="text-align: right;">88.33 ≈ $<span style="white-space:nowrap;"> </span>0.0211</td>
</tr><tr class="even"><td>8</td>
<td style="text-align: right;">1 hour 7 min</td>
<td style="text-align: right;">389.10 ≈ $<span style="white-space:nowrap;"> </span>0.0927</td>
<td style="text-align: right;">88.33 ≈ $<span style="white-space:nowrap;"> </span>0.0211</td>
</tr><tr class="odd"><td>9</td>
<td style="text-align: right;">1 hour 15 min</td>
<td style="text-align: right;">387.59 ≈ $<span style="white-space:nowrap;"> </span>0.0924</td>
<td style="text-align: right;">87.98 ≈ $<span style="white-space:nowrap;"> </span>0.0210</td>
</tr><tr class="even"><td>10</td>
<td style="text-align: right;">1 hour 23 min</td>
<td style="text-align: right;">387.59 ≈ $<span style="white-space:nowrap;"> </span>0.0924</td>
<td style="text-align: right;">87.98 ≈ $<span style="white-space:nowrap;"> </span>0.0210</td>
</tr><tr class="odd"><td>11</td>
<td style="text-align: right;">1 hour 32 min</td>
<td style="text-align: right;">327.51 ≈ $<span style="white-space:nowrap;"> </span>0.0781</td>
<td style="text-align: right;">74.34 ≈ $<span style="white-space:nowrap;"> </span>0.0177</td>
</tr><tr class="even"><td>12</td>
<td style="text-align: right;">1 hour 40 min</td>
<td style="text-align: right;">268.09 ≈ $<span style="white-space:nowrap;"> </span>0.0639</td>
<td style="text-align: right;">60.86 ≈ $<span style="white-space:nowrap;"> </span>0.0145</td>
</tr><tr class="odd"><td>13</td>
<td style="text-align: right;">1 hour 49 min</td>
<td style="text-align: right;">267.37 ≈ $<span style="white-space:nowrap;"> </span>0.0637</td>
<td style="text-align: right;">60.69 ≈ $<span style="white-space:nowrap;"> </span>0.0145</td>
</tr><tr class="even"><td>14</td>
<td style="text-align: right;">1 hour 57 min</td>
<td style="text-align: right;">229.35 ≈ $<span style="white-space:nowrap;"> </span>0.0547</td>
<td style="text-align: right;">52.06 ≈ $<span style="white-space:nowrap;"> </span>0.0124</td>
</tr><tr class="odd"><td>15</td>
<td style="text-align: right;">2 hours 5 min</td>
<td style="text-align: right;">228.31 ≈ $<span style="white-space:nowrap;"> </span>0.0544</td>
<td style="text-align: right;">51.83 ≈ $<span style="white-space:nowrap;"> </span>0.0124</td>
</tr><tr class="even"><td>16</td>
<td style="text-align: right;">2 hours 14 min</td>
<td style="text-align: right;">192.67 ≈ $<span style="white-space:nowrap;"> </span>0.0459</td>
<td style="text-align: right;">43.74 ≈ $<span style="white-space:nowrap;"> </span>0.0104</td>
</tr><tr class="odd"><td>17</td>
<td style="text-align: right;">2 hours 22 min</td>
<td style="text-align: right;">162.07 ≈ $<span style="white-space:nowrap;"> </span>0.0386</td>
<td style="text-align: right;">36.79 ≈ $<span style="white-space:nowrap;"> </span>0.0088</td>
</tr><tr class="even"><td>18</td>
<td style="text-align: right;">2 hours 31 min</td>
<td style="text-align: right;">134.58 ≈ $<span style="white-space:nowrap;"> </span>0.0321</td>
<td style="text-align: right;">30.55 ≈ $<span style="white-space:nowrap;"> </span>0.0073</td>
</tr><tr class="odd"><td>19</td>
<td style="text-align: right;">2 hours 39 min</td>
<td style="text-align: right;">111.42 ≈ $<span style="white-space:nowrap;"> </span>0.0266</td>
<td style="text-align: right;">25.29 ≈ $<span style="white-space:nowrap;"> </span>0.0060</td>
</tr><tr class="even"><td>20</td>
<td style="text-align: right;">2 hours 47 min</td>
<td style="text-align: right;">103.24 ≈ $<span style="white-space:nowrap;"> </span>0.0246</td>
<td style="text-align: right;">23.44 ≈ $<span style="white-space:nowrap;"> </span>0.0056</td>
</tr><tr class="odd"><td>21</td>
<td style="text-align: right;">2 hours 56 min</td>
<td style="text-align: right;">74.96 ≈ $<span style="white-space:nowrap;"> </span>0.0179</td>
<td style="text-align: right;">17.02 ≈ $<span style="white-space:nowrap;"> </span>0.0041</td>
</tr><tr class="even"><td>22</td>
<td style="text-align: right;">3 hours 4 min</td>
<td style="text-align: right;">44.44 ≈ $<span style="white-space:nowrap;"> </span>0.0106</td>
<td style="text-align: right;">10.09 ≈ $<span style="white-space:nowrap;"> </span>0.0024</td>
</tr><tr class="odd"><td>23</td>
<td style="text-align: right;">3 hours 12 min</td>
<td style="text-align: right;">29.85 ≈ $<span style="white-space:nowrap;"> </span>0.0071</td>
<td style="text-align: right;">6.78 ≈ $<span style="white-space:nowrap;"> </span>0.0016</td>
</tr><tr class="even"><td>24</td>
<td style="text-align: right;">3 hours 21 min</td>
<td style="text-align: right;">29.67 ≈ $<span style="white-space:nowrap;"> </span>0.0071</td>
<td style="text-align: right;">6.74 ≈ $<span style="white-space:nowrap;"> </span>0.0016</td>
</tr><tr class="odd"><td>25</td>
<td style="text-align: right;">3 hours 29 min</td>
<td style="text-align: right;">19.14 ≈ $<span style="white-space:nowrap;"> </span>0.0046</td>
<td style="text-align: right;">4.34 ≈ $<span style="white-space:nowrap;"> </span>0.0010</td>
</tr></tbody></table><p><a target="_blank" href="https://web.archive.org/web/20180518225509/https://blog.bitcoinfoundation.org/floating-fees-for-0-10/">https://blog.bitcoinfoundation.org/floating-fees-for-0-10/</a>
